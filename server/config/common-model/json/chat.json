{
  "CHAT": {
    "CHAT_CHECK_EXIST": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "friend_id"
        },
        {
          "TYPE": "number",
          "KEY": "friend_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select * from chat where (user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?)",
      "RESULT": "SINGLE"
    },
    "CHAT_CREATE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "friend_id"
        }
      ],
      "SQL": "INSERT INTO chat (user_id, friend_id) VALUES (?, ?)"
    },
    "CHAT_USER_STATUS_GET": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select * from chat_user_status where user_id = ?",
      "RESULT": "SINGLE"
    },
    "CHAT_USER_STATUS_CREATE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_status"
        }
      ],
      "SQL": "INSERT INTO chat_user_status (user_id, user_status) VALUES (?, ?)"
    },
    "CHAT_DETAIL": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        }
      ],
      "SQL": "select * from chat where chat.id = ?",
      "RESULT": "SINGLE",
      "VALIDATION": "NOT_EXISTS",
      "ERROR_CODE": "DATA_NOT_FOUND"
    },
    "CHAT_USER_DETAIL": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_chat_id"
        }
      ],
      "SQL": "select fos_user.*, chat_user_status.user_status as chat_user_status, cs.is_blocked as chat_block_status from fos_user left join chat_status cs on cs.chat_id = ? and user_id = fos_user.id inner join chat_user_status on chat_user_status.user_id = fos_user.id where fos_user.id = ?",
      "RESULT": "SINGLE",
      "VALIDATION": "NOT_EXISTS",
      "ERROR_CODE": "DATA_NOT_FOUND"
    },
    "CHAT_PAGGING_GET": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "sort",
          "KEY": "sort_by"
        },
        {
          "TYPE": "sort",
          "KEY": "sort_order"
        },
        {
          "TYPE": "number",
          "KEY": "page_size"
        },
        {
          "TYPE": "number",
          "KEY": "page_offset"
        }
      ],
      "SQL": "select chat.*, contacts.id as contacts_id, chat_status.is_unread as chat_read_status from chat inner join chat_status on chat_status.chat_id = chat.id and chat_status.user_id = ? left join contacts on contacts.user_id = chat.user_id and contacts.friend_id = chat.friend_id where chat.user_id = ? OR chat.friend_id = ? ORDER BY #sort_by# #sort_order# LIMIT ? OFFSET ?"
    },
    "CHAT_PAGGING_COUNT_GET": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select count(*) as count from chat where user_id = ? OR friend_id = ?",
      "RESULT": "SINGLE"
    },
    "CHAT_SEND_MESSAGE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "string",
          "KEY": "msg"
        },
        {
          "TYPE": "string",
          "KEY": "attachment_url"
        },
        {
          "TYPE": "string",
          "KEY": "attachment_type"
        },
        {
          "TYPE": "number",
          "KEY": "sender_id"
        },
        {
          "TYPE": "number",
          "KEY": "msg_status"
        },
        {
          "TYPE": "string",
          "KEY": "attachment_name"
        }
      ],
      "SQL": "INSERT INTO chat_message (chat_id, msg, attachment_url, attachment_type, sender_id, msg_status, attachment_name) VALUES (?, ?, ?, ?, ?, ?, ?)"
    },
    "CHAT_UPDATE_LAST_MESSAGE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        }
      ],
      "SQL": "update chat set last_msg_at = now() where id = ?"
    },
    "CHAT_MESSAGE_GET": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "sort",
          "KEY": "sort_by"
        },
        {
          "TYPE": "sort",
          "KEY": "sort_order"
        },
        {
          "TYPE": "number",
          "KEY": "page_size"
        },
        {
          "TYPE": "number",
          "KEY": "page_offset"
        }
      ],
      "SQL": "select * from chat_message where chat_id = ? and (msg_status != 4 OR (msg_status = 4 AND sender_id = ?)) and (delete_status = 0 OR (delete_status = 1 AND sender_id != ?) OR (delete_status = 2 AND sender_id = ?)) ORDER BY #sort_by# #sort_order# LIMIT ? OFFSET ?"
    },
    "CHAT_MESSAGE_COUNT_GET": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select count(*) as count from chat_message where chat_id = ? and (msg_status != 4 OR (msg_status = 4 AND sender_id = ?)) and (delete_status = 0 OR (delete_status = 1 AND sender_id != ?) OR (delete_status = 2 AND sender_id = ?))",
      "RESULT": "SINGLE"
    },
    "CHAT_MESSAGE_DELETE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "msg_status"
        },
        {
          "TYPE": "numberarray",
          "KEY": "chat_messages_id"
        }
      ],
      "SQL": "update chat_message set delete_status = ?, modified_at = now() where id in (?)"
    },
    "CHAT_LIST_MESSAGE_SEARCH": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "string",
          "KEY": "search_key"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "SELECT chat.*, cm.* from chat INNER JOIN chat_message cm on cm.chat_id = chat.id AND (cm.delete_status = 0 OR cm.delete_status !=3) AND (cm.msg_status != 4 OR (cm.msg_status = 4 AND cm.sender_id = ?)) AND ((cm.sender_id = ? and cm.delete_status != 1) OR (cm.sender_id != ? AND cm.delete_status != 2)) WHERE cm.msg LIKE ? AND (chat.user_id = ? OR chat.friend_id = ?) GROUP BY chat.id ORDER BY cm.created_at desc;"
    },
    "CHAT_LIST_CONTACT_SEARCH": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "string",
          "KEY": "search_key"
        },
        {
          "TYPE": "string",
          "KEY": "search_key"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "SELECT chat.*, fu.first_name, fu.last_name, fu.username, fu.cover_image, fu.profile_url, fu.id as master_user_friend_id from chat INNER JOIN fos_user fu ON (fu.id = chat.user_id OR fu.id = chat.friend_id) AND fu.id != ? WHERE (fu.first_name LIKE ? OR fu.last_name LIKE ?) AND (chat.user_id = ? OR chat.friend_id = ?) ORDER BY chat.created_at desc;"
    },
    "CHAT_LAST_MSG_GET": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "SELECT * from chat_message where chat_id = ? AND (msg_status != 4 OR (msg_status = 4 AND sender_id = ?)) AND (delete_status = 0 OR delete_status !=3) AND ((sender_id = ? and delete_status != 1) OR (sender_id != ? AND delete_status != 2)) order by id desc limit 1",
      "RESULT": "SINGLE"
    },
    "CHAT_MSG_FROM_ID": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "id"
        }
      ],
      "SQL": "SELECT * from chat_message where id = ?",
      "RESULT": "SINGLE"
    },
    "CHAT_MESSAGE_STATUS_UPDATE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "msg_status"
        },
        {
          "TYPE": "numberarray",
          "KEY": "message_ids"
        }
      ],
      "SQL": "update chat_message set msg_status = ?, modified_at = now() where id in (?)"
    },
    "CHAT_MARK_AS_READ_UNREAD": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "status"
        },
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "update chat_status set is_unread = ? where chat_id = ? and user_id=?"
    },
    "CHAT_STATUS_CREATE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "insert into chat_status (chat_id, user_id) values (?, ?)"
    },
    "CHAT_USER_STATUS_DETAIL": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select * from chat_status where chat_id = ? and user_id != ?",
      "RESULT": "SINGLE"
    },
    "CHAT_SENDER_STATUS_DETAIL": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select * from chat_status where chat_id = ? and user_id = ?",
      "RESULT": "SINGLE",
      "VALIDATION": "NOT_EXISTS",
      "ERROR_CODE": "DATA_NOT_FOUND"
    },
    "CHAT_UNREAD_MSG_COUNT": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "select count(*) as unread_msg_count from chat_message where msg_status IN (1, 2) AND (delete_status = 0 OR delete_status !=3) AND ((sender_id = ? and delete_status != 1) OR (sender_id != ? AND delete_status != 2)) and chat_id = ? and sender_id != ?",
      "RESULT": "SINGLE"
    },
    "CHAT_READ_ALL_MESSAGE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "update chat_message set msg_status = 3, modified_at = now() where chat_id = ? and sender_id != ? and msg_status != 4 and msg_status != 3"
    },
    "CHAT_GET_ALL_SEND_MESSAGE": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "numberarray",
          "KEY": "chat_msg_status"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        },
        {
          "TYPE": "number",
          "KEY": "user_id"
        }
      ],
      "SQL": "SELECT chat.id FROM chat INNER JOIN chat_message ON chat.id = chat_message.chat_id and sender_id != ? and msg_status in (?) where chat.user_id = ? OR chat.friend_id = ? group by chat.id"
    },
    "CHAT_RECEIVE_ALL_MESSAGE": {
      "PARAMS": [
        {
          "TYPE": "numberarray",
          "KEY": "chat_msg_id"
        }
      ],
      "SQL": "UPDATE chat_message set msg_status = 2, modified_at = now() where id in (?)"
    },
    "CHAT_DETAIL_WITH_USER": {
      "PARAMS": [
        {
          "TYPE": "number",
          "KEY": "chat_id"
        }
      ],
      "SQL": "select chat.*, contacts.id as contacts_id from chat left join contacts on contacts.user_id = chat.user_id and contacts.friend_id = chat.friend_id where chat.id = ? ",
      "RESULT": "SINGLE",
      "VALIDATION": "NOT_EXISTS",
      "ERROR_CODE": "DATA_NOT_FOUND"
    }
  }
}